// EqpCA150.h: interface for the CEquipCA150 class.
//
//////////////////////////////////////////////////////////////////////

#if !defined(AFX_EQPCA150_H__2539B4C7_4B39_45C5_B2DD_A29BCA2143E9__INCLUDED_)
#define AFX_EQPCA150_H__2539B4C7_4B39_45C5_B2DD_A29BCA2143E9__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#include "Equip.h"

// Telesignalisation
const int DEMANDE_ETAT = 1;

// Tableau de puissance incidente et reflechie
const int NIVEAU_PUISSANCE2[256] = {0, 3, 6, 9, 11, 14, 17, 20, 23, 26, 29, 31, 34, 37, 40, 43, 46, 49, 51, 54, 57, 60, 63, 66, 69, 71, 74, 77, 80, 83, 86, 89, 91, 94, 97, 100, 104, 109, 115, 120, 126, 132, 139, 145, 151, 158, 165, 172, 179, 186, 193, 201, 208, 216, 224, 232, 240, 248, 255, 262, 270, 278, 286, 294, 303, 311, 320, 328, 337, 346, 355, 365, 374, 384, 393, 403, 413, 423, 434, 444, 455, 465, 476, 487, 498, 510, 522, 534, 547, 559, 572, 585, 598, 611, 624, 637, 651, 664, 678, 692, 706, 720, 735, 749, 764, 779, 793, 808, 824, 839, 854, 870, 886, 902, 918, 934, 950, 967, 983, 1000, 1024, 1046, 1069, 1092, 1115, 1138, 1161, 1185, 1209, 1233, 1257, 1282, 1306, 1331, 1357, 1382, 1408, 1434, 1460, 1487, 1500, 1531, 1561, 1592, 1624, 1655, 1687, 1720, 1752, 1785, 1818, 1852, 1886, 1920, 1954, 1989, 2024, 2059, 2095, 2131, 2167, 2204, 2241, 2278, 2315, 2353, 2391, 2430, 2469, 2508, 2547, 2587, 2627, 2667, 2708, 2749, 2791, 2832, 2875, 2917, 2960, 3003, 3046, 3090, 3134, 3179, 3223, 3268, 3314, 3360, 3406, 3452, 3499, 3546, 3594, 3642, 3690, 3739, 3788, 3837, 3887, 3937, 3987, 4038, 4066, 4130, 4194, 4259, 4325, 4391, 4457, 4524, 4592, 4660, 4728, 4797, 4866, 4936, 5007, 5078, 5149, 5221, 5294, 5367, 5440, 5514, 5589, 5664, 5740, 5816, 5892, 5970, 6026, 6123, 6222, 6321, 6421, 6521, 6623, 6724, 6827, 6930, 7000, 7122, 7246, 7370, 7495, 7621, 7748, 7875, 8009, 8204, 8401, 8599, 8799, 9000};
const int NIVEAU_PUISSANCE1[256] = {0, 2, 5, 7, 9, 11, 14, 16, 18, 20, 23, 25, 27, 30, 32, 34, 36, 39, 41, 43, 45, 48, 50, 53, 56, 58, 60, 63, 66, 69, 71, 74, 76, 79, 82, 84, 87, 90, 93, 95, 98, 100, 104, 108, 113, 117, 122, 127, 132, 137, 142, 147, 153, 158, 164, 170, 175, 181, 187, 193, 200, 206, 212, 219, 225, 232, 239, 246, 253, 260, 267, 275, 282, 290, 297, 305, 313, 321, 329, 337, 345, 354, 362, 371, 380, 388, 397, 406, 415, 425, 434, 443, 453, 462, 472, 482, 492, 502, 508, 517, 528, 538, 548, 558, 569, 579, 590, 601, 612, 622, 634, 645, 656, 667, 679, 690, 702, 714, 726, 738, 750, 760, 775, 790, 805, 821, 836, 852, 868, 884, 900, 916, 933, 949, 966, 983, 1000, 1017, 1034, 1051, 1069, 1087, 1104, 1122, 1140, 1158, 1177, 1195, 1214, 1233, 1252, 1271, 1290, 1309, 1328, 1348, 1368, 1388, 1408, 1428, 1448, 1469, 1489, 1510, 1531, 1552, 1573, 1594, 1616, 1637, 1659, 1681, 1703, 1725, 1747, 1770, 1792, 1815, 1838, 1861, 1884, 1907, 1931, 1955, 1978, 2002, 2026, 2050, 2075, 2087, 2122, 2151, 2193, 2229, 2265, 2302, 2339, 2376, 2413, 2450, 2488, 2526, 2565, 2603, 2642, 2681, 2721, 2760, 2800, 2841, 2881, 2922, 2963, 3004, 3046, 3088, 3130, 3172, 3215, 3258, 3301, 3345, 3389, 3433, 3477, 3522, 3567, 3612, 3658, 3704, 3750, 3796, 3843, 3890, 3937, 3985, 4033, 4081, 4130, 4178, 4227, 4277, 4326, 4376, 4427, 4477, 4528, 4579, 4631, 4682, 4735, 4787, 4840, 4893, 4946, 5000};

typedef enum
{
	MASTER = 0, SLAVE = 1
} TypeCA;

class CEquipCA150:public CEquip
{
public:
	CEquipCA150(int idx, TypeCA type);
	virtual ~CEquipCA150();
	void	Allocation();
	BOOL	Charge_Contexte(char *fichier);
	BOOL	Sauve_Contexte(char *fichier);
	BOOL	Power();
	void	InitialiserSH();
	void	InitialiserCharge();
	void	ChgtEtatSH(int idx, bool etat);
	void	ChgtEtatCharge(int idx, bool etat);
	void	EnvoiEtatCyclique();
	char*	DemandeEtat();
	void	ChgtCombineMaster(bool etat);

	// Variables globales du master
	TypeCA		TYPE;
	bool		TIMER;
	bool		LOCAL;
	bool		MAUVAIS_ROS;
	bool		DEFAUT;
	bool		COMBINE;
	bool		*CHARGE;
	bool		SURCHAUFFE_HYBRIDE[4];
	int			PUISSANCE_INCIDENTE;
	int			PUISSANCE_REFLECHIE;
};

#endif // !defined(AFX_EQPCA150_H__2539B4C7_4B39_45C5_B2DD_A29BCA2143E9__INCLUDED_)
